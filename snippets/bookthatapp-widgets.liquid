{%- comment -%}
BookThatApp Widgets Bootstrap Loader. This file is automatically generated. We recommend
that you do not modify this file as any modifications will be overwritten with next App
update. Contact support@zetya.com if you need assistance with BookThatApp.

== Version: 1.4 ==
{%- endcomment -%}

{%- if content_for_header contains 'bta-installed.js' -%}
  <script>
    {%- comment -%} BookThatApp config {%- endcomment -%}
    var productConfig = {}, productMetafields;
    {% if product.metafields.bookthatapp.config_json %}
    productMetafields = '{{ product.metafields.bookthatapp.config_json | json }}';
    if (productMetafields !== '') {
      productConfig = JSON.parse(productMetafields);
    }
    {% else %}
    productMetafields = '{{ product.metafields.bookthatapp.config }}'; {%- comment -%} legacy metafields {%- endcomment -%}
    if (productMetafields !== '') {
      productConfig = JSON.parse('{"' + decodeURI(productMetafields).replace(/"/g, '\\"').replace(/&/g, '","').replace(/=/g,'":"') + '"}');
    }
    {% endif %}
    window.BtaConfig = {
      account: '{{ shop.permanent_domain | split: '.' | first }}',
      settings: JSON.parse('{{ shop.metafields.bookthatapp.config }}' || '{}'),
      {% if product %} 'product': productConfig,{% endif %}
      cart: {{ cart | json }},
      version: '1.4'
    }
</script>
{{ 'bta-widgets-bootstrap.min.js' | asset_url  | script_tag }}
{%- endif -%}
